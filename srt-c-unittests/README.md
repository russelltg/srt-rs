These are unit tests taken from the reference implemention